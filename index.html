<!DOCTYPE html>
<html lang="zh">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="theme-color" content=#58b77a>
  <title>Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="author" content="北音执念">
  <meta name="keywords" content="">
  <meta name="description" content="人生在世苦难很多也要笑着过">
  <script id="hexo-configurations">
  var CONFIG = {
    root: '/',
    theme: 'A-Chief-Lx',
    version: '0.3.9',
    localsearch:{
      "enable": false,
      "trigger": "auto",
      "top_n_per_article": 1,
      "unescape": false,
      "preload": false
      },
    path: '-'
  };
</script>

  <link rel="shortcut icon" href="/favicon.ico">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/theme-lx@0.3.9/source/css/main.min.css">
  <style type="text/css">
    pre,
    code {
      font-family: 'Fira Code', monospace;
    }
    html {
      font-family: sans-serif;
    }
    body {
      font-family: sans-serif;
    }
    h1, h2, h3, h4, h5, figure {
      font-family: sans-serif;
    }
    .menu-container{
      font-family: sans-serif;
    }
  </style>

  <script src="//cdn.jsdelivr.net/npm/jquery@3.4.1/dist/jquery.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/theme-lx@0.3.9/source/js/jquery.jside.menu.js"></script>
	<script>
	$(document).ready(function(){
	$(".menu-container").jSideMenu({
	    jSidePosition: "position-right",
	    jSideSticky: true,
	    jSideSkin: "greenish",
	     });
	}); 
	</script>
  
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Fira Code:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/font-awesome@4/css/font-awesome.min.css">
</head>
<body>
<div id="page">

<div id="lx-aside" style="background-image: url(//cdn.jsdelivr.net/npm/theme-lx@0.3.9/source/images/cover.jpeg)">
  <div class="overlay">
  <div class="featured">
    <div class="avatar"><a href="/"><img src="/images/avatar.jpeg"></a></div>
    <span>北音执念</span>
    <h1>Hexo</h1>
    <span>——记录生活</span>
    
  </div>
  </div>
</div>

<div id="lx-main-content">
  <div class="lx-post"> 

  <div class="lx-entry padding">
    <div>
      <h2 class="title"><a href="/2020/06/17/%E6%9C%8D%E5%8A%A1%EF%BC%8C%E7%89%B9%E6%80%A7/">服务，特性</a></h2>
      <span class="lx-post-detail"><i class="fa fa-calendar-o"></i> 2020-06-17</span>
      <p><!DOCTYPE html>

<html> <!--用于定义文档的头部，描述了文档各种属性和信息-->

  <head>
           <script>
            var services_discovered = false;//5接课
            //5接课
     //presence of services and characteristics
     var has_accelerometer_service = false;
     var has_accelerometer_data = false;
     var has_led_matrix_state = false;
     var has_led_matrix_state = false;
     var has_device_information_service = false;
     var has_model_number_string = false;
     //servicers UUIDs
     ACCELEROMETER_SERVICE = 'e95d0753-251d-470a-a062-fa1922dfa9a8';
     LED_SERVICE = 'e95dd91d-251d-470a-a062-fa1922dfa9a8';
     DEVICE_INFORMATION_SERVICE = '0000180a-0000-1000-8000-00805f9b34fb';
     //characteristics UUIDs
     ACCELEROMETER_DATA = 'e95dca4b-251d-470a-a062-fa1922dfa9a8';
     LED_MATRIX_STATE = 'e95dd91d-251d-470a-a062-fa1922dfa9a8';
     MODEL_NUMBER_STRING = '00002a24-0000-1000-8000-00805f9b34fb';
     //cached characteristics
     var led_matrix_state
     var model_number_string;
     var accelerometer_data;
     //
     var service_count;
     var services_discovered;
     var characteristic_count;
     var characteristics_discovered;
               function resetUI()//第四节课基础上添加函数
     {
       setConnectedStatus(false);
       setConnectedStatus(false);//第五节课基础上添加函数
     }
               function discoverSvcsAndChars()//第五节课添加函数
     {
         console.log("discoverSvcsAndChars server= " + connected_server);
         connected_server.getPrimaryServices()
         .then(services =>
         {
           has_accelerometer_service = false;
           has_led_service = false;
           has_device_information_service = false;

<pre><code>      services_discovered = 0;
      service_count = services.length;
      console.log(&quot;Got&quot; +  service_count + &quot;services&quot;);

      services.forEach(service =&gt; {
        if(service.uuid == ACCELEROMETER_SERVICE)
        {
         has_accelerometer_service = true;
        }
        if(service.uuid == LED_SERVICE)
        {
         has_led_service = true;
        }
        if(service.uuid == DEVICE_INFORMATION_SERVICE)
        {
         has_device_information_service = true;
        }
        console.log(&apos;Getting Characteristics for servicer&apos; + service.uuid);
        service.getCharacteristics()
        .then(getCharacteristics =&gt;
        {
          console.log(&apos;&gt; Service:&apos; + service.uuid);
          services_discovered++;
          Characteristics_discovered = 0;
          Characteristic_count = Characteristic.length;
          Characteristics.forEach(characteristics =&gt;
          {
           characteristics_discovered++;
           console.log(&apos;&gt;&gt; Characteristics:&apos; + characteristics.uuid);
           if(characteristics.uuid == ACCELEROMETER_DATA)
           {
            accelerometer_data = characteristics;
            has_accelerometer_data = true;
           }
           if(characteristics.uuid == LED_MATRIX_STATE)
           {
            led_matrix_state = characteristics;
            has_led_matrix_state = true;
           }
           if(characteristics.uuid == MODEL_NUMBER_STRING)
           {
            model_number_string= characteristics;
            has_model_number_string = true;
           }
           if(services_discovered == service_count&amp;&amp;characteristics_discovered == characteristic_count)
           {
             console.log(&quot;FINISHED DISCOVERY&quot;);
             setDiscoveryStatus(true);
             //setDiscoveryStatus(true);
           }
          });

        });

      });
    });

}
       &lt;/script&gt;</code></pre>  <meta name="generator" content="Hexo 4.2.0"></head>

</p>
      <div class="post-button"><a class="btn" href="/2020/06/17/%E6%9C%8D%E5%8A%A1%EF%BC%8C%E7%89%B9%E6%80%A7/" rel="noopener"><i class="fa fa-angle-double-right fa-fw"></i>Read More</a></div>
    </div>
  </div>
  <div class="lx-entry padding">
    <div>
      <h2 class="title"><a href="/2020/06/17/%E8%BF%9E%E6%8E%A5%E7%8A%B6%E6%80%81%E5%92%8C%E6%96%AD%E5%BC%80%E8%BF%9E%E6%8E%A5/">连接状态和断开连接</a></h2>
      <span class="lx-post-detail"><i class="fa fa-calendar-o"></i> 2020-06-17</span>
      <p><!DOCTYPE html>

<html> <!--用于定义文档的头部，描述了文档各种属性和信息-->

  <head>
      <script>
          function setConnectedStatus(status)  //在第三课基础上添加的函数，设置电脑蓝牙当前的连接状态
        {
            connected = status;
            document.getElementById('status_connected').innerHTML = status;
            if (status == true)
            {
                document.getElementById('btn_scan').innerHTML = "Disconnect";//连接完成之后就需要断开连接，disconnect断开连接
            }
            else
            {
                document.getElementById('btn_scan').innerHTML = "Discover Devices";
            }
        }
          function discoverOrdisconnectDevices()//第四节课
     {
       console.log("discoverOrdisconnectDevices");
       if(!connected)
       {
         discoverDevices();
       }
       else
       {
         selected_device.gatt.disconnect();//断开连接
       }
     }

<pre><code>function onDisconnected()//4课
{
  console.log(&quot;onDisconnected&quot;);
  resetUI();
}
function setDiscoveryStatus(status)
{
  services_discovered = status;
  document.getElementById(&apos;statu
 &lt;/script&gt;</code></pre>  <meta name="generator" content="Hexo 4.2.0"></head>





<p>​            </p>
</p>
      <div class="post-button"><a class="btn" href="/2020/06/17/%E8%BF%9E%E6%8E%A5%E7%8A%B6%E6%80%81%E5%92%8C%E6%96%AD%E5%BC%80%E8%BF%9E%E6%8E%A5/" rel="noopener"><i class="fa fa-angle-double-right fa-fw"></i>Read More</a></div>
    </div>
  </div>
  <div class="lx-entry padding">
    <div>
      <h2 class="title"><a href="/2020/06/17/%E7%AC%AC%E4%BA%8C%E8%AF%BE%E8%BF%9E%E6%8E%A5%E8%AE%BE%E5%A4%87/">第二课连接设备</a></h2>
      <span class="lx-post-detail"><i class="fa fa-calendar-o"></i> 2020-06-17</span>
      <p><!DOCTYPE html>

<html> <!--用于定义文档的头部，描述了文档各种属性和信息-->

  <head>
       <script>
            var selected_device ;   //<!--选择用户选择的蓝牙设备-->
            var connected_server;  //<!--保存用户选择的蓝牙设备-->
            var   connected = false;
            function discoverDevices()
            {  
             console.log("discoverDevices");//<!--console，log控制台打印输出-->
             var options = {acceptAllDevices:true}//发现周边蓝牙设备
             navigator.bluetooth.requestDevice(options)//navigator对象，包含浏览器信息
            .then(device => {
            console.log('> Name:' + device.name);
            console.log('> Id:' + device.id);  
            console.log('> Connected:' + device.gatt.connected);
            selected_device =device;
            console.log(selected_device);
            connect();
            })
            .catch(error => {
            alert('ERROR ' + error);
            console.log('ERROR:' + error);
             });
     }
           function connect()///第二节课添加函数
     { 
       console.log("connecting");
       selected_device.gatt.connect()
       .then(
                function(server) //表示连接成功
                {
                  console.log("Connected to" + server.device.id);
                  console.log("Connected=" + server.connected);
                  //selected_device.addEventListener('gattserverdisconnected',onDisconnected);

<pre><code>             connected_server=server;
             //discoverSvcsAndChars();//第5节课添加函数
             //setConnectedStatus(true);//第三节课添加函数,设置电脑蓝牙当前连接状态
           },
          function(error)//表示连接失败
          {
            console.log(&quot;ERROR:could not connct-&quot; + error);
            alert(&quot;ERROR:could not connct-&quot; + error);
            setConnectedStatus(false);
          }
         );
}</code></pre>  <meta name="generator" content="Hexo 4.2.0"></head>

<p>&lt;/ html&gt;</p>
</p>
      <div class="post-button"><a class="btn" href="/2020/06/17/%E7%AC%AC%E4%BA%8C%E8%AF%BE%E8%BF%9E%E6%8E%A5%E8%AE%BE%E5%A4%87/" rel="noopener"><i class="fa fa-angle-double-right fa-fw"></i>Read More</a></div>
    </div>
  </div>
  <div class="lx-entry padding">
    <div>
      <h2 class="title"><a href="/2020/06/17/%E5%87%86%E5%A4%87%E5%89%8D%E7%9A%84/">准备前的</a></h2>
      <span class="lx-post-detail"><i class="fa fa-calendar-o"></i> 2020-06-17</span>
      <p><p>一、确认本机上是否安装蓝牙</p>
<p>●法-:在桌面开始按钮旁的搜索栏中输入bluetooth后回车, 看蓝牙是否打开</p>
<p>●法二:在chrome浏览器的地址栏中输入chr ome://bluetooth-internals，看是否能发现周边蓝牙设备。上述网址是一个Chrome浏览器的插件, 使用它可以查看电脑周边蓝牙设备的信息:状态、服务、特性、描述符等。</p>
<img src="C:\Users\ASUS\Pictures\QQ图片20200617152920.png" style="zoom:25%;" />

<img src="C:\Users\ASUS\Pictures\QQ图片20200617153007.png" style="zoom:25%;" />



<p>二、检查本机系统、chrome 浏览器的版本</p>
<p>，Chrome的70.0.3526.0及以上。</p>
<p>窗口关闭按钮的下方-&gt;帮助&gt;关于Google Chrome</p>
<img src="C:\Users\ASUS\Pictures\QQ图片20200617153545.png" style="zoom:25%;" />

<img src="C:\Users\ASUS\Pictures\QQ图片20200617153636.png" style="zoom:25%;" />

<img src="C:\Users\ASUS\Pictures\QQ图片20200617153720.png" style="zoom:25%;" />

<p>●Windows 10的1703及以上。</p>
<p>在桌面开始按钮旁的搜索栏中输入winver回车即可查看本机的版本号。注意，在MSDN网站上可以查看/下载Windows.系统的历史版本。</p>
<p>请注意:网页蓝牙功能并非只有Chrome浏览器支持，其他如Firefox、Safari也都可以。 但网页蓝牙的API及内部实现都是Chrome团队在开发，因此Chrome对该功能支持的最好。不同浏览器对网页蓝牙的实现及支持现状请看这里。</p>
<p>三、下载固件至开发板</p>
<p>如果microbit开发板要和我们电脑通过蓝牙来通信,则需要通过程序来启用板子上的蓝牙模块。因此需要下载能够实现该功能的固件，点击这里下载。</p>
<p>四、测试</p>
<p>在chr ome浏览器的地址栏中输入chr ome://bluetooth-internals,进入Devices后选择Name为BBCmicro:bit [gitup]的一 -行。若板子上显示字符C,则表示电脑端和板子端正常运行</p>
</p>
      <div class="post-button"><a class="btn" href="/2020/06/17/%E5%87%86%E5%A4%87%E5%89%8D%E7%9A%84/" rel="noopener"><i class="fa fa-angle-double-right fa-fw"></i>Read More</a></div>
    </div>
  </div>
  <div class="lx-entry padding">
    <div>
      <h2 class="title"><a href="/2020/06/16/h2Statush2%20!--%E6%98%BE%E7%A4%BA%E8%93%9D%E7%89%99%E7%8A%B6%E6%80%81--/">h2Statush2 !--显示蓝牙状态--</a></h2>
      <span class="lx-post-detail"><i class="fa fa-calendar-o"></i> 2020-06-16</span>
      <p><p>h2&gt;Status</h2> <!--显示蓝牙状态--></p>
<table border="1">

 <tr>

  <td> <b>Connected</b></td>

  <td><b>Service Discovery Completed</b></td>

 </tr><!--表格第一行-->

 <tr>

  <td id="Status_connected"> false </td>

  <td id="Status_discovered"> false </td>

 </tr><!--表格第二行-->

</table>

<h2>Device Discovery</h2><!--扫描/发现蓝牙设备-->



<p><button id="btn_scan" onclick="discoverDevices()">Start scan</button></p>
</p>
      <div class="post-button"><a class="btn" href="/2020/06/16/h2Statush2%20!--%E6%98%BE%E7%A4%BA%E8%93%9D%E7%89%99%E7%8A%B6%E6%80%81--/" rel="noopener"><i class="fa fa-angle-double-right fa-fw"></i>Read More</a></div>
    </div>
  </div>
  <div class="lx-entry padding">
    <div>
      <h2 class="title"><a href="/2020/06/16/function%20setConnectedStatus(Status)%20%E7%AC%AC%E4%B8%89%E8%8A%82%E8%AF%BE%E6%B7%BB%E5%8A%A0%E5%87%BD%E6%95%B0%EF%BC%8C%E8%AE%BE%E7%BD%AE%E7%94%B5%E8%84%91%E8%93%9D%E7%89%99%E5%BD%93%E5%89%8D%E8%BF%9E%E6%8E%A5%E7%8A%B6%E6%80%81/">function setConnectedStatus(Status) 第三节课添加函数，设置电脑蓝牙当前连接状态</a></h2>
      <span class="lx-post-detail"><i class="fa fa-calendar-o"></i> 2020-06-16</span>
      <p><p>function setConnectedStatus(Status) //第三节课添加函数，设置电脑蓝牙当前连接状态</p>
<p>   {</p>
<p>​    connect = status;</p>
<p>​    document.getElementById(‘status_connected’).innerHTML = status;</p>
<p>​    if(status==true)</p>
<p>​    {</p>
<p>​     document.getElementById(‘btn_scan’).innerHTML = “Disconnect”;</p>
<p>​    }</p>
<p>​    else</p>
<p>​    {</p>
<p>​     document.getElementById(‘btn_scan’).innerHTML=”Discover Devices”;</p>
<p>​    }</p>
<p>   }</p>
<p>   function setDiscoveryStatus(status)</p>
<p>   {</p>
<p>​    services_discovered = status;</p>
<p>​    document.getElementById(‘status.discovered’).innerHTML = status;</p>
<p>   }</p>
<p>   function resetUI()//第四节课基础上添加函数</p>
<p>   {</p>
<p>​    setConnectedStatus(false);</p>
<p>​    setConnectedStatus(false);//第五节课基础上添加函数</p>
<p>   }</p>
<p>   function discoverSvcsAndChars()//第五节课添加函数</p>
<p>   {</p>
<p>​     console.log(“discoverSvcsAndChars server= “ + connected_server);</p>
<p>​     connected_server.getPrimaryServices()</p>
<p>​     .then(services =&gt;</p>
<p>​     {</p>
<p>​      has_accelerometer_service = false;</p>
<p>​      has_led_service = false;</p>
<p>​      has_device_information_service = false;</p>
<p>​      services_discovered = 0;</p>
<p>​      service_count = services.length;</p>
<p>​      console.log(“Got” + service_count + “services”);</p>
<p>​      services.forEach(service =&gt; {</p>
<p>​       if(service.uuid == ACCELEROMETER_SERVICE)</p>
<p>​       {</p>
<p>​       has_accelerometer_service = true;</p>
<p>​       }</p>
<p>​       if(service.uuid == LED_SERVICE)</p>
<p>​       {</p>
<p>​       has_led_service = true;</p>
<p>​       }</p>
<p>​       if(service.uuid == DEVICE_INFORMATION_SERVICE)</p>
<p>​       {</p>
<p>​       has_device_information_service = true;</p>
<p>​       }</p>
<p>​       console.log(‘Getting Characteristics for servicer’ + service.uuid);</p>
<p>​       service.getCharacteristics()</p>
<p>​       .then(getCharacteristics =&gt;</p>
<p>​       {</p>
<p>​        console.log(‘&gt; Service:’ + service.uuid);</p>
<p>​        services_discovered++;</p>
<p>​        Characteristics_discovered = 0;</p>
<p>​        Characteristic_count = Characteristic.length;</p>
<p>​        Characteristics.forEach(characteristics =&gt;</p>
<p>​        {</p>
<p>​        characteristics_discovered++;</p>
<p>​        console.log(‘&gt;&gt; Characteristics:’ + characteristics.uuid);</p>
<p>​        if(characteristics.uuid == ACCELEROMETER_DATA)</p>
<p>​        {</p>
<p>​         accelerometer_data = characteristics;</p>
<p>​         has_accelerometer_data = true;</p>
<p>​        }</p>
<p>​        if(characteristics.uuid == LED_MATRIX_STATE)</p>
<p>​        {</p>
<p>​         led_matrix_state = characteristics;</p>
<p>​         has_led_matrix_state = true;</p>
<p>​        }</p>
<p>​        if(characteristics.uuid == MODEL_NUMBER_STRING)</p>
<p>​        {</p>
<p>​         model_number_string= characteristics;</p>
<p>​         has_model_number_string = true;</p>
<p>​        }</p>
<p>​        if(services_discovered == service_count&amp;&amp;characteristics_discovered == characteristic_count)</p>
<p>​        {</p>
<p>​         console.log(“FINISHED DISCOVERY”);</p>
<p>​         setDiscoveryStatus(true);</p>
<p>​         //setDiscoveryStatus(true);</p>
<p>​        }</p>
<p>​        }</p>
<p>​        )</p>
<p>​       }</p>
<p>​       )</p>
<p>​      });</p>
<p>​     }</p>
<p>​     )</p>
<p>   }</p>
</p>
      <div class="post-button"><a class="btn" href="/2020/06/16/function%20setConnectedStatus(Status)%20%E7%AC%AC%E4%B8%89%E8%8A%82%E8%AF%BE%E6%B7%BB%E5%8A%A0%E5%87%BD%E6%95%B0%EF%BC%8C%E8%AE%BE%E7%BD%AE%E7%94%B5%E8%84%91%E8%93%9D%E7%89%99%E5%BD%93%E5%89%8D%E8%BF%9E%E6%8E%A5%E7%8A%B6%E6%80%81/" rel="noopener"><i class="fa fa-angle-double-right fa-fw"></i>Read More</a></div>
    </div>
  </div>
  <div class="lx-entry padding">
    <div>
      <h2 class="title"><a href="/2020/06/16/function%20discoverOrdisconnectDevices()%E7%AC%AC%E5%9B%9B%E8%8A%82%E8%AF%BE/">function discoverOrdisconnectDevices()第四节课</a></h2>
      <span class="lx-post-detail"><i class="fa fa-calendar-o"></i> 2020-06-16</span>
      <p><p>function discoverOrdisconnectDevices()//第四节课</p>
<p>   {</p>
<p>​    console.log(“discoverOrdisconnectDevices”);</p>
<p>​    if(!connected)</p>
<p>​    {</p>
<p>​     discoverDevices();</p>
<p>​    }</p>
<p>​    else</p>
<p>​    {</p>
<p>​     selected_device.gatt.disconnect();//断开连接</p>
<p>​    }</p>
<p>   }</p>
<p>   function onDisconnected()//4课</p>
<p>   {</p>
<p>​    console.log(“onDisconnected”);</p>
<p>​    resetUI();</p>
<p>   }</p>
<p>  function discoverDevices()</p>
<p>   { </p>
<p>​    console.log(“discoverDevices”);//<!--console，log控制台打印输出--></p>
<p>​    var options = {acceptAllDevices:true}</p>
<p>​    navigator.bluetooth.requestDevice(options)</p>
<p>​    .then(device =&gt; {</p>
<p>​      console.log(‘&gt; Name:’ + device.name);</p>
<p>​      console.log(‘&gt; Id:’ + device.id); </p>
<p>​      console.log(‘&gt; Connected:’ + device.gatt.connected);</p>
<p>​      selected_device=device;</p>
<p>​      console.log(selected_device);</p>
<p>​      connect();</p>
<p>​     })</p>
<p>​    .catch(error =&gt; {</p>
<p>​      alert(‘ERROR ‘ + error);</p>
<p>​      console.log(‘ERROR:’ + error);</p>
<p>​       });</p>
<p>   }</p>
<p>   function connect()///第二节课添加函数</p>
<p>   { </p>
<p>​    console.log(“connecting”);</p>
<p>​    selected_device.gatt.connect()</p>
<p>​    .then(</p>
<p>​        function(server) //表示连接成功</p>
<p>​        {</p>
<p>​         console.log(“Connected to” + server.device.id);</p>
<p>​         console.log(“Connected=” + server.connected);</p>
<p>​         selected_device.addEventListener(‘gattserverdisconnected’,onDisconnected);</p>
<p>​         connected_server=server;</p>
<p>​         discoverSvcsAndChars();//第5节课添加函数</p>
<p>​         setConnectedStatus(true);//第三节课添加函数,设置电脑蓝牙当前连接状态</p>
<p>​        },</p>
<p>​        function(error)//表示连接失败</p>
<p>​        {</p>
<p>​         console.log(“ERROR:could not connct-“ + error);</p>
<p>​         alert(“ERROR:could not connct-“ + error);</p>
<p>​         setConnectedStatus(false);</p>
<p>​        }</p>
<p>​       );</p>
<p>   }</p>
</p>
      <div class="post-button"><a class="btn" href="/2020/06/16/function%20discoverOrdisconnectDevices()%E7%AC%AC%E5%9B%9B%E8%8A%82%E8%AF%BE/" rel="noopener"><i class="fa fa-angle-double-right fa-fw"></i>Read More</a></div>
    </div>
  </div>
  <div class="lx-entry padding">
    <div>
      <h2 class="title"><a href="/2020/06/16/var%20%20selected_device%20;%20%20!--%E4%BF%9D%E5%AD%98%E7%94%A8%E6%88%B7%E9%80%89%E6%8B%A9%E7%9A%84%E8%93%9D%E7%89%99%E8%AE%BE%E5%A4%87--/">var  selected_device ;  !--保存用户选择的蓝牙设备--</a></h2>
      <span class="lx-post-detail"><i class="fa fa-calendar-o"></i> 2020-06-16</span>
      <p><p>var  selected_device ;  //<!--保存用户选择的蓝牙设备--></p>
<p>   var  connected_server;  //在第二节课基础上添加的变量，保存电脑当前蓝牙连接状态</p>
<p>   var  connected = false;</p>
<p>   var services_discovered = false;//5接课</p>
<p>   //5接课</p>
<p>   //presence of services and characteristics</p>
<p>   var has_accelerometer_service = false;</p>
<p>   var has_accelerometer_data = false;</p>
<p>   var has_led_matrix_state = false;</p>
<p>   var has_led_matrix_state = false;</p>
<p>   var has_device_information_service = false;</p>
<p>   var has_model_number_string = false;</p>
<p>   //servicers UUIDs</p>
<p>   ACCELEROMETER_SERVICE = ‘e95d0753-251d-470a-a062-fa1922dfa9a8’;</p>
<p>   LED_SERVICE = ‘e95dd91d-251d-470a-a062-fa1922dfa9a8’;</p>
<p>   DEVICE_INFORMATION_SERVICE = ‘0000180a-0000-1000-8000-00805f9b34fb’;</p>
<p>   //characteristics UUIDs</p>
<p>   ACCELEROMETER_DATA = ‘e95dca4b-251d-470a-a062-fa1922dfa9a8’;</p>
<p>   LED_MATRIX_STATE = ‘e95dd91d-251d-470a-a062-fa1922dfa9a8’;</p>
<p>   MODEL_NUMBER_STRING = ‘00002a24-0000-1000-8000-00805f9b34fb’;</p>
<p>   //cached characteristics</p>
<p>   var led_matrix_state</p>
<p>   var model_number_string;</p>
<p>   var accelerometer_data;</p>
<p>   //</p>
<p>   var service_count;</p>
<p>   var services_discovered;</p>
<p>   var characteristic_count;</p>
<p>   var characteristics_discovered;</p>
</p>
      <div class="post-button"><a class="btn" href="/2020/06/16/var%20%20selected_device%20;%20%20!--%E4%BF%9D%E5%AD%98%E7%94%A8%E6%88%B7%E9%80%89%E6%8B%A9%E7%9A%84%E8%93%9D%E7%89%99%E8%AE%BE%E5%A4%87--/" rel="noopener"><i class="fa fa-angle-double-right fa-fw"></i>Read More</a></div>
    </div>
  </div>
  <div class="lx-entry padding">
    <div>
      <h2 class="title"><a href="/2020/06/16/%E9%A1%B9%E7%9B%AE%E4%BA%8C/">项目二</a></h2>
      <span class="lx-post-detail"><i class="fa fa-calendar-o"></i> 2020-06-16</span>
      <p><!DOCTYPE html>
<html>
<head><!--用于定义文档的头部，描述了文档各种属性和信息-->
  <script>
     var   selected_device ;   //<!--保存用户选择的蓝牙设备-->
     var   connected_server;   //在第二节课基础上添加的变量，保存电脑当前蓝牙连接状态
     var   connected = false;
     var services_discovered = false;//5接课
     //5接课
     //presence of services and characteristics
     var has_accelerometer_service = false;
     var has_accelerometer_data = false;
     var has_led_matrix_state = false;
     var has_led_matrix_state = false;
     var has_device_information_service = false;
     var has_model_number_string = false;
     //servicers UUIDs
     ACCELEROMETER_SERVICE = 'e95d0753-251d-470a-a062-fa1922dfa9a8';
     LED_SERVICE = 'e95dd91d-251d-470a-a062-fa1922dfa9a8';
     DEVICE_INFORMATION_SERVICE = '0000180a-0000-1000-8000-00805f9b34fb';
     //characteristics UUIDs
     ACCELEROMETER_DATA = 'e95dca4b-251d-470a-a062-fa1922dfa9a8';
     LED_MATRIX_STATE = 'e95dd91d-251d-470a-a062-fa1922dfa9a8';
     MODEL_NUMBER_STRING = '00002a24-0000-1000-8000-00805f9b34fb';
     //cached characteristics
     var led_matrix_state
     var model_number_string;
     var accelerometer_data;
     //
     var service_count;
     var services_discovered;
     var characteristic_count;
     var characteristics_discovered;

<pre><code> &lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;&lt;!--用于定义文档的头部，描述了文档各种属性和信息--&gt;
  &lt;script&gt;
     var   selected_device ;   //&lt;!--保存用户选择的蓝牙设备--&gt;
     var   connected_server;   //在第二节课基础上添加的变量，保存电脑当前蓝牙连接状态
     var   connected = false;
     var services_discovered = false;//5接课
     //5接课
     //presence of services and characteristics
     var has_accelerometer_service = false;
     var has_accelerometer_data = false;
     var has_led_matrix_state = false;
     var has_led_matrix_state = false;
     var has_device_information_service = false;
     var has_model_number_string = false;
     //servicers UUIDs
     ACCELEROMETER_SERVICE = &apos;e95d0753-251d-470a-a062-fa1922dfa9a8&apos;;
     LED_SERVICE = &apos;e95dd91d-251d-470a-a062-fa1922dfa9a8&apos;;
     DEVICE_INFORMATION_SERVICE = &apos;0000180a-0000-1000-8000-00805f9b34fb&apos;;
     //characteristics UUIDs
     ACCELEROMETER_DATA = &apos;e95dca4b-251d-470a-a062-fa1922dfa9a8&apos;;
     LED_MATRIX_STATE = &apos;e95dd91d-251d-470a-a062-fa1922dfa9a8&apos;;
     MODEL_NUMBER_STRING = &apos;00002a24-0000-1000-8000-00805f9b34fb&apos;;
     //cached characteristics
     var led_matrix_state
     var model_number_string;
     var accelerometer_data;
     //
     var service_count;
     var services_discovered;
     var characteristic_count;
     var characteristics_discovered;

     function discoverOrdisconnectDevices()//第四节课
     {
       console.log(&quot;discoverOrdisconnectDevices&quot;);
       if(!connected)
       {
         discoverDevices();
       }
       else
       {
         selected_device.gatt.disconnect();//断开连接
       }
     }

     function onDisconnected()//4课
     {
       console.log(&quot;onDisconnected&quot;);
       resetUI();
     }

     function discoverDevices()
     {  
        console.log(&quot;discoverDevices&quot;);//&lt;!--console，log控制台打印输出--&gt;
        var options = {acceptAllDevices:true}
        navigator.bluetooth.requestDevice(options)
        .then(device =&gt; {
            console.log(&apos;&gt; Name:&apos; + device.name);
            console.log(&apos;&gt; Id:&apos; + device.id);  
            console.log(&apos;&gt; Connected:&apos; + device.gatt.connected);
            selected_device=device;
            console.log(selected_device);
            connect();
         })
        .catch(error =&gt; {
            alert(&apos;ERROR &apos; + error);
            console.log(&apos;ERROR:&apos; + error);
             });
     }
     function connect()///第二节课添加函数
     { 
       console.log(&quot;connecting&quot;);
       selected_device.gatt.connect()
       .then(
                function(server) //表示连接成功
                {
                  console.log(&quot;Connected to&quot; + server.device.id);
                  console.log(&quot;Connected=&quot; + server.connected);
                  selected_device.addEventListener(&apos;gattserverdisconnected&apos;,onDisconnected);

                  connected_server=server;
                  discoverSvcsAndChars();//第5节课添加函数
                  setConnectedStatus(true);//第三节课添加函数,设置电脑蓝牙当前连接状态
                },
               function(error)//表示连接失败
               {
                 console.log(&quot;ERROR:could not connct-&quot; + error);
                 alert(&quot;ERROR:could not connct-&quot; + error);
                 setConnectedStatus(false);
               }
              );
     }

     function setConnectedStatus(Status)  //第三节课添加函数，设置电脑蓝牙当前连接状态
     {
       connect = status;
       document.getElementById(&apos;status_connected&apos;).innerHTML = status;
       if(status==true)
       {
          document.getElementById(&apos;btn_scan&apos;).innerHTML = &quot;Disconnect&quot;;
       }
       else
       {
          document.getElementById(&apos;btn_scan&apos;).innerHTML=&quot;Discover Devices&quot;;
       }
     }


     function setDiscoveryStatus(status)
     {
       services_discovered = status;
       document.getElementById(&apos;status.discovered&apos;).innerHTML = status;
     }

 function onDisconnected()//4课
     {
       console.log(&quot;onDisconnected&quot;);
       resetUI();
     }

     function discoverDevices()
     {  
        console.log(&quot;discoverDevices&quot;);//&lt;!--console，log控制台打印输出--&gt;
        var options = {acceptAllDevices:true}
        navigator.bluetooth.requestDevice(options)
        .then(device =&gt; {
            console.log(&apos;&gt; Name:&apos; + device.name);
            console.log(&apos;&gt; Id:&apos; + device.id);  
            console.log(&apos;&gt; Connected:&apos; + device.gatt.connected);
            selected_device=device;
            console.log(selected_device);
            connect();
         })
        .catch(error =&gt; {
            alert(&apos;ERROR &apos; + error);
            console.log(&apos;ERROR:&apos; + error);
             });
     }
     function connect()///第二节课添加函数
     { 
       console.log(&quot;connecting&quot;);
       selected_device.gatt.connect()
       .then(
                function(server) //表示连接成功
                {
                  console.log(&quot;Connected to&quot; + server.device.id);
                  console.log(&quot;Connected=&quot; + server.connected);
                  selected_device.addEventListener(&apos;gattserverdisconnected&apos;,onDisconnected);

                  connected_server=server;
                  discoverSvcsAndChars();//第5节课添加函数
                  setConnectedStatus(true);//第三节课添加函数,设置电脑蓝牙当前连接状态
                },
               function(error)//表示连接失败
               {
                 console.log(&quot;ERROR:could not connct-&quot; + error);
                 alert(&quot;ERROR:could not connct-&quot; + error);
                 setConnectedStatus(false);
               }
              );
     }

     function setConnectedStatus(Status)  //第三节课添加函数，设置电脑蓝牙当前连接状态
     {
       connect = status;
       document.getElementById(&apos;status_connected&apos;).innerHTML = status;
       if(status==true)
       {
          document.getElementById(&apos;btn_scan&apos;).innerHTML = &quot;Disconnect&quot;;
       }
       else
       {
          document.getElementById(&apos;btn_scan&apos;).innerHTML=&quot;Discover Devices&quot;;
       }
     }


     function setDiscoveryStatus(status)
     {
       services_discovered = status;
       document.getElementById(&apos;status.discovered&apos;).innerHTML = status;
     }

     function resetUI()//第四节课基础上添加函数
     {
       setConnectedStatus(false);
       setConnectedStatus(false);//第五节课基础上添加函数
     }

     function discoverSvcsAndChars()//第五节课添加函数
     {
         console.log(&quot;discoverSvcsAndChars server= &quot; + connected_server);
         connected_server.getPrimaryServices()
         .then(services =&gt;
         {
           has_accelerometer_service = false;
           has_led_service = false;
           has_device_information_service = false;

           services_discovered = 0;
           service_count = services.length;
           console.log(&quot;Got&quot; +  service_count + &quot;services&quot;);

           services.forEach(service =&gt; {
             if(service.uuid == ACCELEROMETER_SERVICE)
             {
              has_accelerometer_service = true;
             }
             if(service.uuid == LED_SERVICE)
             {
              has_led_service = true;
             }
             if(service.uuid == DEVICE_INFORMATION_SERVICE)
             {
              has_device_information_service = true;
             }
             console.log(&apos;Getting Characteristics for servicer&apos; + service.uuid);
             service.getCharacteristics()
             .then(getCharacteristics =&gt;
             {
               console.log(&apos;&gt; Service:&apos; + service.uuid);
               services_discovered++;
               Characteristics_discovered = 0;
               Characteristic_count = Characteristic.length;
               Characteristics.forEach(characteristics =&gt;
               {
                characteristics_discovered++;
                console.log(&apos;&gt;&gt; Characteristics:&apos; + characteristics.uuid);
                if(characteristics.uuid == ACCELEROMETER_DATA)
                {
                 accelerometer_data = characteristics;
                 has_accelerometer_data = true;
                }
                if(characteristics.uuid == LED_MATRIX_STATE)
                {
                 led_matrix_state = characteristics;
                 has_led_matrix_state = true;
                }
                if(characteristics.uuid == MODEL_NUMBER_STRING)
                {
                 model_number_string= characteristics;
                 has_model_number_string = true;
                }
                if(services_discovered == service_count&amp;&amp;characteristics_discovered == characteristic_count)
                {
                  console.log(&quot;FINISHED DISCOVERY&quot;);
                  setDiscoveryStatus(true);
                  //setDiscoveryStatus(true);
                }
               }
               )
             }
             )
           });
         }
         )
     }
  &lt;/script&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;h2&gt;Status&lt;/h2&gt;  &lt;!--显示蓝牙状态--&gt;
&lt;table border=&quot;1&quot;&gt;
  &lt;tr&gt;
    &lt;td&gt; &lt;b&gt;Connected&lt;/b&gt;&lt;/td&gt;
    &lt;td&gt;&lt;b&gt;Service Discovery Completed&lt;/b&gt;&lt;/td&gt;
  &lt;/tr&gt;&lt;!--表格第一行--&gt;
  &lt;tr&gt;
    &lt;td id=&quot;Status_connected&quot;&gt; false &lt;/td&gt;
    &lt;td id=&quot;Status_discovered&quot;&gt; false &lt;/td&gt;
  &lt;/tr&gt;&lt;!--表格第二行--&gt;
&lt;/table&gt;
&lt;h2&gt;Device Discovery&lt;/h2&gt;&lt;!--扫描/发现蓝牙设备--&gt;

&lt;button id=&quot;btn_scan&quot;  onclick=&quot;discoverDevices()&quot;&gt;Start scan&lt;/button&gt;

&lt;/body&gt;
&lt;/html&gt;</code></pre></p>
      <div class="post-button"><a class="btn" href="/2020/06/16/%E9%A1%B9%E7%9B%AE%E4%BA%8C/" rel="noopener"><i class="fa fa-angle-double-right fa-fw"></i>Read More</a></div>
    </div>
  </div>
  <div class="lx-entry padding">
    <div>
      <h2 class="title"><a href="/2020/06/16/%E4%B8%80%E3%80%81%E7%A1%AE%E8%AE%A4%E6%9C%AC%E6%9C%BA%E4%B8%8A%E6%98%AF%E5%90%A6%E5%AE%89%E8%A3%85%E8%93%9D%E7%89%99/">一、确认本机上是否安装蓝牙</a></h2>
      <span class="lx-post-detail"><i class="fa fa-calendar-o"></i> 2020-06-16</span>
      <p><p>一、确认本机上是否安装蓝牙</p>
<p>●法-:在桌面开始按钮旁的搜索栏中输入bluetooth后回车, 看蓝牙是否打开。</p>
<p>●法二:在chrome浏览器的地址栏中输入chr ome://bluetooth-internals，看是否能发现周边蓝牙设备。上述网址是一个Chrome浏览器的插件, 使用它可以查看电脑周边蓝牙设备的信息:状态、服务、特性、描述符等。</p>
<p>二、检查本机系统、chrome 浏览器的版本</p>
<p>，Chrome的70.0.3526.0及以上。</p>
<p>窗口关闭按钮的下方-&gt;帮助&gt;关于Google Chrome</p>
<p>●Windows 10的1703及以上。</p>
<p>在桌面开始按钮旁的搜索栏中输入winver回车即可查看本机的版本号。注意，在MSDN网站上可以查看/下载Windows.系统的历史版本。</p>
<p>请注意:网页蓝牙功能并非只有Chrome浏览器支持，其他如Firefox、Safari也都可以。 但网页蓝牙的API及内部实现都是Chrome团队在开发，因此Chrome对该功能支持的最好。不同浏览器对网页蓝牙的实现及支持现状请看这里。</p>
<p>三、下载固件至开发板</p>
<p>如果microbit开发板要和我们电脑通过蓝牙来通信,则需要通过程序来启用板子上的蓝牙模块。因此需要下载能够实现该功能的固件，点击这里下载。</p>
<p>四、测试</p>
<p>在chr ome浏览器的地址栏中输入chr ome://bluetooth-internals,进入Devices后选择Name为BBCmicro:bit [gitup]的一 -行。若板子上显示字符C,则表示电脑端和板子端正常运行。</p>
</p>
      <div class="post-button"><a class="btn" href="/2020/06/16/%E4%B8%80%E3%80%81%E7%A1%AE%E8%AE%A4%E6%9C%AC%E6%9C%BA%E4%B8%8A%E6%98%AF%E5%90%A6%E5%AE%89%E8%A3%85%E8%93%9D%E7%89%99/" rel="noopener"><i class="fa fa-angle-double-right fa-fw"></i>Read More</a></div>
    </div>
  </div>


<div id="pagination">
  <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/"></a>
</div>

<footer>
  <div>
  Copyright &copy; 2019.<a href="/">Hexo</a><br>Powered by <a href="https://hexo.io" target="_blank">Hexo</a> | Theme <a href="https://lx.js.org" target="_blank">Lx</a><br>
  </div>
</footer>

  </div>
</div>
</div>

<button class="hamburger hamburger--arrow-r" type="button">
    <div class="hamburger-box">
      <div class="hamburger-inner"></div>
    </div>
</button> 
<div class="menu visibility">
  <div class="menu-head">
    <span class="layer">
      <div class="col">
        <div class="row for-pic">
          <div class="profile-pic">
            <a href="/"><img src="/images/avatar.jpeg" alt="北音执念"/></a>
          </div>
        </div>
        <div class="row for-name">
          <p>北音执念</p>
          <span class="tagline">Hello, World!</span>
        </div>
      </div>
    </span>
  </div>
  <nav class="menu-container">
  <ul class="menu-items">
    <li><a href="/"><i class="fa fa-home fa-fw"></i>Home</a></li>
    <li><a href="/archives/"><i class="fa fa-archive fa-fw"></i>Archives</a></li>
    
    <li class="has-sub"><span class="dropdown-heading">
      <i class="fa fa-bookmark fa-fw"></i>Pages</span>
        <ul>
          <li><a href="/guestbook/">Guestbook</a></li>
        <li><a href="/about/">About</a></li>
        </ul>
    </li>
    <li class="has-sub"><span class="dropdown-heading">
      <i class="fa fa-link fa-fw"></i>Friends</span>
        <ul>
          <li> <a href="https://lx.js.org" target="_blank">Theme-Lx</a></li>
        </ul>
    </li>
  </ul>
  </nav>
</div>

<div class="gototop js-top">
  <a href="#" class="js-gotop"><i class="fa fa-arrow-up"></i></a>
</div>
<script src="//cdn.jsdelivr.net/npm/theme-lx@0.3.9/source/js/jquery.easing.min.js"></script>
<script>
(function () {
	"use strict";
	var goToTop = function() {
		$(".js-gotop").on("click", function(event){
			event.preventDefault();
			$("html, body").animate({
				scrollTop: $("html").offset().top
			}, 500, "easeInOutExpo");
			return false;
		});
		$(window).scroll(function(){
			var $win = $(window);
			if ($win.scrollTop() > 200) {
				$(".js-top").addClass("active");
			} else {
				$(".js-top").removeClass("active");
			}
		});
	};
	$(function(){
		goToTop();
	});
}());
</script>


</body>
</html>
